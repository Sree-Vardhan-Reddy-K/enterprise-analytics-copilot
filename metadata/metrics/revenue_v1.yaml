metric_name: revenue
version: v1
description: >
  Total revenue from completed orders.
  Revenue is recognized only for orders with status COMPLETED.

grain: orders.order_id

time_column: orders.order_date

tables:
  fact: orders
  dimensions:
    - users
    - products

joins:
  - left: orders.user_id
    right: users.id
    type: inner

  - left: orders.product_id
    right: products.id
    type: inner

measure:
  expression: orders.amount
  aggregation: sum

required_filters:
  - column: orders.status
    operator: "="
    value: COMPLETED

allowed_dimensions:
  - region
  - product
  - user_city

allowed_filters:
  - status
  - region
  - product

forbidden_filters:
  - internal_account
  - refund_status

supports_dimensions: false

pii_exposure: false

xyz: true